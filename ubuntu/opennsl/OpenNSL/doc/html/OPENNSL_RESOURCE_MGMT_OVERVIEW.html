<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>OpenNSL API Guide and Reference Manual: Resource Management</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen_brcm.css" rel="stylesheet" type="text/css" />
<link href="tabs_brcm.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">OpenNSL API Guide and Reference Manual
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.2 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Welcome</span></a></li>
      <li class="current"><a href="pages.html"><span>OpenNSL&#160;Documentation</span></a></li>
      <li><a href="modules.html"><span>API&#160;Reference</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">Resource Management </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>Resource Manager(RM) is used for partitioning switch resources and ensuring traffic/resource isolation among control plane applications. It mediates access to the hardware resources from multiple logical switch pipelines. The main responsibilities of resource manager (RM) are:</p>
<ul>
<li>Provides a mechanism to define and create a switch resource profile (SRP) that allocates/reserves switch resources for a given control plane application. The shared switch resources that can be reserved/allocated via the profile are: Port table VLAN table L2 FDB table L3 unicast tables, VRFs, Routes, Hosts, ECMP etc. L3 Multicast tables Policy table QoS mapping table</li>
</ul>
<ul>
<li>Maintains a one-to-one mapping between application and the profile to ensure that resources allocated for the profile can only be used by one application.</li>
</ul>
<ul>
<li>Ensures that the overall resources do not exceed the capacity of the underlying switch devices.</li>
</ul>
<ul>
<li>Enforces scaling limits per application as specified in the resource profile.</li>
</ul>
<ul>
<li>Provide an isolation of switch resources among applications. For resources that are allocated successfully, RM ensures that a given resource can only be configured by the associated owner.</li>
</ul>
<ul>
<li>Provides a means to update the profile parameters during run time.</li>
</ul>
<ul>
<li>Provides filtering mechanism to isolate asynchronous switch events like Packet RX, Link event, L2 learn/age callbacks. Even though these are not resources, RM prevents notifying every switch event to every application.</li>
</ul>
<p>The RM API is a layer in the OpenNSL library above the SDK API. Currently this covers only a subset of modules in the SDK. This is illustrated in the below diagram:</p>
<div class="image">
<img src="OpenNSLRMLayer.jpg" alt="OpenNSLRMLayer.jpg"/>
<div class="caption">
Figure 2</div></div>
<p> For an application to use the RM functionality, it should first register its resource requirements with the Resource Manager using <a class="el" href="group__rm.html#ga26321248f110b621bcbfc326d51a6d43" title="Used to register with Resource Manager.">opennsl_rm_register()</a> API. This registration returns the application a client-ID handle, which needs to be passed in all the RM provided APIs. The Network OS is considered as the default RM client and will not explicitly register with RM. It can however specify its resource requirements in multiple ways as explained in the next section. Currently, the RM APIs of the SDK modules can only be invoked from the proposed OFDPA driver layer which will be part of the OpenNSL library. If OFDPA driver layer does not register with RM and if the Network OS does not explicitly specify its resource requirements to RM, then all the switch resources will be owned by the Network OS. This is same as the behavior without RM functionality.</p>
<h1><a class="anchor" id="OPENNSL_RM_CUSTOMIZATION"></a>
RM customization</h1>
<p>OpenNSL provides a mechanism to customize the default RM profile, by accepting a set of properties through a configuration file. The properties are mainly used to customize RM default profile without having to re-compile the OpenNSL. OpenNSL accepts the RM configuration from a file. During initialization, OpenNSL checks for the presence of configuration file. If the file exists, the configuration from the file is applied. Run-time modifications to the configuration file do not take effect until OpenNSL is re-initialized.</p>
<p>The configuration file is retrieved in the following order: </p>
<ul>
<li>The config file is specified via environment variable OPENNSL_RM_CONFIG_FILE. This option is given the highest precedence so that configuration files can be changed without recompiling code.</li>
</ul>
<pre>
     # export OPENNSL_RM_CONFIG_FILE=/home/admin/rm.cfg
</pre><ul>
<li>The config file is specified as an input parameter to the <a class="el" href="driver_8h.html#a06a6fe41f5ea8664c461423d3cad0923" title="Function to initialize the switch.">opennsl_driver_init()</a> function. rv = opennsl_driver_init(params);</li>
</ul>
<ul>
<li>The location '/etc/opennsl' is checked for presence of 'rm.cfg' file.</li>
</ul>
<ul>
<li>If the config file is not specified or does not exist, OpenNSL applies the default RM profile configuration, which is owning all the resources.</li>
</ul>
<p>End users can potentially use different configuration files based on the resource partitioning.</p>
<h1><a class="anchor" id="OPENNSL_RM_CONFIG_PROPERTIES"></a>
Config properties</h1>
<p>A property is a 'name=value' pair where name is a string and value is typically specified as a list of number or range depending on the property type. Current defined properties are rm_ports and rm_vlans.</p>
<p>Example: To own the physical port 1 to physical port 29 and vlans 4,8,10-15, use "rm_ports=1-29" and "rm_vlans=4,8,10-15" </p>
</div></div><!-- contents -->
<!-- HTML footer for doxygen 1.8.5-->
<!-- start footer part -->
<!--BEGIN GENERATE_TREEVIEW -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
<hr>
<p>	
<table class="footer-brcm">
	<tr>
		<td class="footer-brcm"><img src="BRCM_Red+Black_noTag_RGB.png" align=left></td>
		<td class="footer-brcm"><small><b>&copy;  2016 by Broadcom Corporation. All rights reserved.</b></small>
			<div class="footer-brcm"><small>Broadcom Corporation reserves the right to make changes without further notice to any products or data herein to improve reliability, function, or design. 
Information furnished by Broadcom Corporation is believed to be accurate and reliable. However, Broadcom Corporation does not assume any liability arising 
out of the application or use of this information, nor the application or use of any product or circuit described herein, neither does it convey any license 
under its patent rights nor the rights of others. </small>
			</div>
		</td>
	</tr>
</table>	
</p>	
</div>
<!--END GENERATE_TREEVIEW-->
</body>
</html>
